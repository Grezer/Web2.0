<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Task 2</title>
</head>
    <body>        
        <p> <input type="text" name="Имя">  Имя </p>
        <p> <input type="text" name="ДР"> День рождения </p>
        <p> <input type="text" name="ДС"> День смерти </p>
        <p> <input type="text" name="Вес"> Вес </p>
        <p> <input type="text" name="Длина"> Длина </p>
        <p> <input type="text" name="Высота"> Высота </p>
        <p> <input type="text" name="Пол"> Пол </p>
        <p> <select id = "Species"> </select> Вид </p>
        <p><button onclick="CreateAnimals()">Добавить животных</button></p>
    </body>
</html>
<script>
    loadSpecies();

    function loadSpecies() {
        var FirstConnect = new XMLHttpRequest();
        FirstConnect.onreadystatechange = function () {
                    if (FirstConnect.readyState == 4 && FirstConnect.status == 200) {                    
                        openJSON(FirstConnect.responseText);
                    }
                }
            FirstConnect.open("GET", 'https://apex.oracle.com/pls/apex/gruneworld/zoo/species', true);
            FirstConnect.send();
        }

    function openJSON(response) {
        var arr = JSON.parse(response);
        var select = document.body.children[0];
        arr.items.forEach(element => {
            var newOption = new Option(element.name, element.id);   
            var h = document.getElementById("Species");
            h.appendChild(newOption);   
        });
    }

    function CreateAnimals() {
    var xhr = new XMLHttpRequest();
    var url = "https://apex.oracle.com/pls/apex/gruneworld/zoo//animals";
    xhr.open("POST", url, true);
    xhr.setRequestHeader("Content-Type", "application/json");
    xhr.onreadystatechange = function () {
        if (xhr.readyState === 4 && xhr.status === 200) {
            // 
        }
    };
    var sel = document.getElementById("Species"); 
    var n = sel.options[sel.selectedIndex].value; 
    var data = JSON.stringify({
        "name": document.getElementsByName("Имя")[0].value, 
        "SPECIES_ID": n,
        "Birth": document.getElementsByName("ДР")[0].value,
        "Death": document.getElementsByName("ДС")[0].value,
        "Weight": document.getElementsByName("Вес")[0].value,
        "Length": document.getElementsByName("Длина")[0].value,
        "Height": document.getElementsByName("Высота")[0].value,
        "Sex": document.getElementsByName("Пол")[0].value   
        });
    xhr.send(data);
    }
</script>